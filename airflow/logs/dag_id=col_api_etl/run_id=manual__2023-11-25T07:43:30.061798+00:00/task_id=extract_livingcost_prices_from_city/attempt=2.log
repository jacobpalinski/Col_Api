[2023-11-25T07:46:09.772+0000] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: col_api_etl.extract_livingcost_prices_from_city manual__2023-11-25T07:43:30.061798+00:00 [queued]>
[2023-11-25T07:46:09.783+0000] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: col_api_etl.extract_livingcost_prices_from_city manual__2023-11-25T07:43:30.061798+00:00 [queued]>
[2023-11-25T07:46:09.783+0000] {taskinstance.py:1361} INFO - Starting attempt 2 of 2
[2023-11-25T07:46:09.798+0000] {taskinstance.py:1382} INFO - Executing <Task(PythonOperator): extract_livingcost_prices_from_city> on 2023-11-25 07:43:30.061798+00:00
[2023-11-25T07:46:09.806+0000] {standard_task_runner.py:57} INFO - Started process 1482 to run task
[2023-11-25T07:46:09.806+0000] {clientserver.py:543} INFO - Closing down clientserver connection
[2023-11-25T07:46:09.812+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'col_api_etl', 'extract_livingcost_prices_from_city', 'manual__2023-11-25T07:43:30.061798+00:00', '--job-id', '13', '--raw', '--subdir', 'DAGS_FOLDER/col_api_etl.py', '--cfg-path', '/tmp/tmpwgp70632']
[2023-11-25T07:46:09.816+0000] {standard_task_runner.py:85} INFO - Job 13: Subtask extract_livingcost_prices_from_city
[2023-11-25T07:46:09.892+0000] {task_command.py:415} INFO - Running <TaskInstance: col_api_etl.extract_livingcost_prices_from_city manual__2023-11-25T07:43:30.061798+00:00 [running]> on host 7a58d25e4770
[2023-11-25T07:46:10.207+0000] {taskinstance.py:1660} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='col_api_etl' AIRFLOW_CTX_TASK_ID='extract_livingcost_prices_from_city' AIRFLOW_CTX_EXECUTION_DATE='2023-11-25T07:43:30.061798+00:00' AIRFLOW_CTX_TRY_NUMBER='2' AIRFLOW_CTX_DAG_RUN_ID='manual__2023-11-25T07:43:30.061798+00:00'
[2023-11-25T07:46:10.742+0000] {logging_mixin.py:151} INFO - Dubai
[2023-11-25T07:46:11.528+0000] {logging_mixin.py:151} INFO - Abu-Dhabi
[2023-11-25T07:46:12.146+0000] {logging_mixin.py:151} INFO - Sharjah
[2023-11-25T07:46:12.952+0000] {logging_mixin.py:151} INFO - Perth
[2023-11-25T07:46:13.556+0000] {logging_mixin.py:151} INFO - Melbourne
[2023-11-25T07:46:14.377+0000] {logging_mixin.py:151} INFO - Sydney
[2023-11-25T07:46:14.997+0000] {logging_mixin.py:151} INFO - Brisbane
[2023-11-25T07:46:15.854+0000] {logging_mixin.py:151} INFO - Adelaide
[2023-11-25T07:46:16.778+0000] {logging_mixin.py:151} INFO - Canberra
[2023-11-25T07:46:17.391+0000] {logging_mixin.py:151} INFO - Darwin
[2023-11-25T07:46:18.188+0000] {logging_mixin.py:151} INFO - Sarajevo
[2023-11-25T07:46:18.841+0000] {logging_mixin.py:151} INFO - Manama
[2023-11-25T07:46:19.801+0000] {logging_mixin.py:151} INFO - Sofia
[2023-11-25T07:46:20.682+0000] {logging_mixin.py:151} INFO - Sao-Paulo
[2023-11-25T07:46:21.689+0000] {logging_mixin.py:151} INFO - Rio-De-Janeiro
[2023-11-25T07:46:22.801+0000] {logging_mixin.py:151} INFO - Brasilia
[2023-11-25T07:46:23.586+0000] {logging_mixin.py:151} INFO - Toronto
[2023-11-25T07:46:24.938+0000] {logging_mixin.py:151} INFO - Montreal
[2023-11-25T07:46:26.046+0000] {logging_mixin.py:151} INFO - Vancouver
[2023-11-25T07:46:26.874+0000] {logging_mixin.py:151} INFO - Ottawa
[2023-11-25T07:46:27.487+0000] {logging_mixin.py:151} INFO - Calgary
[2023-11-25T07:46:28.314+0000] {logging_mixin.py:151} INFO - Edmonton
[2023-11-25T07:46:29.125+0000] {logging_mixin.py:151} INFO - Halifax
[2023-11-25T07:46:29.738+0000] {logging_mixin.py:151} INFO - Quebec-City
[2023-11-25T07:46:30.545+0000] {logging_mixin.py:151} INFO - Zurich
[2023-11-25T07:46:31.145+0000] {logging_mixin.py:151} INFO - Geneva
[2023-11-25T07:46:31.967+0000] {logging_mixin.py:151} INFO - Zug
[2023-11-25T07:46:32.786+0000] {logging_mixin.py:151} INFO - Basel
[2023-11-25T07:46:33.393+0000] {logging_mixin.py:151} INFO - Bern
[2023-11-25T07:46:34.224+0000] {logging_mixin.py:151} INFO - Lausanne
[2023-11-25T07:46:34.842+0000] {logging_mixin.py:151} INFO - Lugano
[2023-11-25T07:46:35.679+0000] {logging_mixin.py:151} INFO - Vaduz
[2023-11-25T07:46:36.288+0000] {logging_mixin.py:151} INFO - Santiago
[2023-11-25T07:46:37.104+0000] {logging_mixin.py:151} INFO - Chongqing
[2023-11-25T07:46:37.894+0000] {logging_mixin.py:151} INFO - Shanghai
[2023-11-25T07:46:38.490+0000] {logging_mixin.py:151} INFO - Beijing
[2023-11-25T07:46:39.313+0000] {logging_mixin.py:151} INFO - Chengdu
[2023-11-25T07:46:39.926+0000] {logging_mixin.py:151} INFO - Guangzhou
[2023-11-25T07:46:40.750+0000] {logging_mixin.py:151} INFO - Shenzhen
[2023-11-25T07:46:41.363+0000] {logging_mixin.py:151} INFO - Bogota
[2023-11-25T07:46:42.169+0000] {logging_mixin.py:151} INFO - Medellin
[2023-11-25T07:46:42.963+0000] {logging_mixin.py:151} INFO - Cali
[2023-11-25T07:46:43.568+0000] {logging_mixin.py:151} INFO - Cartagena
[2023-11-25T07:46:44.387+0000] {logging_mixin.py:151} INFO - San-Jose
[2023-11-25T07:46:44.984+0000] {logging_mixin.py:151} INFO - Prague
[2023-11-25T07:46:45.821+0000] {logging_mixin.py:151} INFO - Brno
[2023-11-25T07:46:46.442+0000] {logging_mixin.py:151} INFO - Ostrava
[2023-11-25T07:46:47.271+0000] {logging_mixin.py:151} INFO - Copenhagen
[2023-11-25T07:46:48.087+0000] {logging_mixin.py:151} INFO - Aarhus
[2023-11-25T07:46:48.690+0000] {logging_mixin.py:151} INFO - Aalborg
[2023-11-25T07:46:49.500+0000] {logging_mixin.py:151} INFO - Andorra-La-Vella
[2023-11-25T07:46:50.094+0000] {logging_mixin.py:151} INFO - Vienna
[2023-11-25T07:46:50.888+0000] {logging_mixin.py:151} INFO - Salzburg
[2023-11-25T07:46:51.500+0000] {logging_mixin.py:151} INFO - Graz
[2023-11-25T07:46:52.306+0000] {logging_mixin.py:151} INFO - Linz
[2023-11-25T07:46:53.132+0000] {logging_mixin.py:151} INFO - Innsbruck
[2023-11-25T07:46:53.736+0000] {logging_mixin.py:151} INFO - Brussels
[2023-11-25T07:46:54.548+0000] {logging_mixin.py:151} INFO - Antwerp
[2023-11-25T07:46:55.146+0000] {logging_mixin.py:151} INFO - Gent
[2023-11-25T07:46:56.103+0000] {logging_mixin.py:151} INFO - Liege
[2023-11-25T07:46:57.082+0000] {logging_mixin.py:151} INFO - Brugge
[2023-11-25T07:46:58.016+0000] {logging_mixin.py:151} INFO - Zagreb
[2023-11-25T07:46:59.081+0000] {logging_mixin.py:151} INFO - Split
[2023-11-25T07:46:59.975+0000] {logging_mixin.py:151} INFO - Dubrovnik
[2023-11-25T07:47:01.162+0000] {logging_mixin.py:151} INFO - Nicosia
[2023-11-25T07:47:02.121+0000] {logging_mixin.py:151} INFO - Tallinn
[2023-11-25T07:47:03.111+0000] {logging_mixin.py:151} INFO - Tartu
[2023-11-25T07:47:03.925+0000] {logging_mixin.py:151} INFO - Helsinki
[2023-11-25T07:47:04.536+0000] {logging_mixin.py:151} INFO - Turku
[2023-11-25T07:47:05.360+0000] {logging_mixin.py:151} INFO - Tampere
[2023-11-25T07:47:05.984+0000] {logging_mixin.py:151} INFO - Oulu
[2023-11-25T07:47:06.779+0000] {logging_mixin.py:151} INFO - Paris
[2023-11-25T07:47:07.372+0000] {logging_mixin.py:151} INFO - Marseille
[2023-11-25T07:47:08.223+0000] {logging_mixin.py:151} INFO - Lyon
[2023-11-25T07:47:09.017+0000] {logging_mixin.py:151} INFO - Toulouse
[2023-11-25T07:47:09.630+0000] {logging_mixin.py:151} INFO - Nice
[2023-11-25T07:47:10.454+0000] {logging_mixin.py:151} INFO - Nantes
[2023-11-25T07:47:11.050+0000] {logging_mixin.py:151} INFO - Montpellier
[2023-11-25T07:47:11.875+0000] {logging_mixin.py:151} INFO - Berlin
[2023-11-25T07:47:12.671+0000] {logging_mixin.py:151} INFO - Hamburg
[2023-11-25T07:47:13.285+0000] {logging_mixin.py:151} INFO - Munich
[2023-11-25T07:47:14.085+0000] {logging_mixin.py:151} INFO - Stuttgart
[2023-11-25T07:47:14.696+0000] {logging_mixin.py:151} INFO - Frankfurt
[2023-11-25T07:47:15.532+0000] {logging_mixin.py:151} INFO - Cologne
[2023-11-25T07:47:16.148+0000] {logging_mixin.py:151} INFO - Dusseldorf
[2023-11-25T07:47:16.966+0000] {logging_mixin.py:151} INFO - Hanover
[2023-11-25T07:47:17.755+0000] {logging_mixin.py:151} INFO - Dresden
[2023-11-25T07:47:18.367+0000] {logging_mixin.py:151} INFO - Leipzig
[2023-11-25T07:47:19.175+0000] {logging_mixin.py:151} INFO - Athens
[2023-11-25T07:47:19.766+0000] {logging_mixin.py:151} INFO - Crete
[2023-11-25T07:47:20.587+0000] {logging_mixin.py:151} INFO - Thessaloniki
[2023-11-25T07:47:21.185+0000] {logging_mixin.py:151} INFO - Dublin
[2023-11-25T07:47:21.990+0000] {logging_mixin.py:151} INFO - Cork
[2023-11-25T07:47:22.833+0000] {logging_mixin.py:151} INFO - Galway
[2023-11-25T07:47:23.437+0000] {logging_mixin.py:151} INFO - Rome
[2023-11-25T07:47:24.243+0000] {logging_mixin.py:151} INFO - Milan
[2023-11-25T07:47:24.833+0000] {logging_mixin.py:151} INFO - Naples
[2023-11-25T07:47:25.656+0000] {logging_mixin.py:151} INFO - Turin
[2023-11-25T07:47:26.288+0000] {logging_mixin.py:151} INFO - Palermo
[2023-11-25T07:47:27.086+0000] {logging_mixin.py:151} INFO - Genoa
[2023-11-25T07:47:27.877+0000] {logging_mixin.py:151} INFO - Bologna
[2023-11-25T07:47:28.475+0000] {logging_mixin.py:151} INFO - Florence
[2023-11-25T07:47:29.279+0000] {logging_mixin.py:151} INFO - Riga
[2023-11-25T07:47:29.869+0000] {logging_mixin.py:151} INFO - Vilnius
[2023-11-25T07:47:30.656+0000] {logging_mixin.py:151} INFO - Luxembourg
[2023-11-25T07:47:31.244+0000] {logging_mixin.py:151} INFO - Valletta
[2023-11-25T07:47:32.076+0000] {logging_mixin.py:151} INFO - Podgorica
[2023-11-25T07:47:32.880+0000] {logging_mixin.py:151} INFO - Monaco
[2023-11-25T07:47:33.540+0000] {logging_mixin.py:151} INFO - Amsterdam
[2023-11-25T07:47:34.702+0000] {logging_mixin.py:151} INFO - Rotterdam
[2023-11-25T07:47:35.465+0000] {logging_mixin.py:151} INFO - Eindhoven
[2023-11-25T07:47:36.586+0000] {logging_mixin.py:151} INFO - The-Hague
[2023-11-25T07:47:37.558+0000] {logging_mixin.py:151} INFO - Groningen
[2023-11-25T07:47:38.763+0000] {logging_mixin.py:151} INFO - Tilburg
[2023-11-25T07:47:39.882+0000] {logging_mixin.py:151} INFO - Lisbon
[2023-11-25T07:47:40.484+0000] {logging_mixin.py:151} INFO - Porto
[2023-11-25T07:47:41.295+0000] {logging_mixin.py:151} INFO - Braga
[2023-11-25T07:47:41.893+0000] {logging_mixin.py:151} INFO - Funchal
[2023-11-25T07:47:42.702+0000] {logging_mixin.py:151} INFO - San-Marino
[2023-11-25T07:47:43.503+0000] {logging_mixin.py:151} INFO - Bratislava
[2023-11-25T07:47:44.098+0000] {logging_mixin.py:151} INFO - Ljubljana
[2023-11-25T07:47:44.897+0000] {logging_mixin.py:151} INFO - Madrid
[2023-11-25T07:47:45.494+0000] {logging_mixin.py:151} INFO - Barcelona
[2023-11-25T07:47:46.297+0000] {logging_mixin.py:151} INFO - Santa-Cruz-De-Tenerife
[2023-11-25T07:47:46.915+0000] {logging_mixin.py:151} INFO - Valencia
[2023-11-25T07:47:47.712+0000] {logging_mixin.py:151} INFO - Seville
[2023-11-25T07:47:48.527+0000] {logging_mixin.py:151} INFO - Zaragoza
[2023-11-25T07:47:49.139+0000] {logging_mixin.py:151} INFO - Malaga
[2023-11-25T07:47:49.958+0000] {logging_mixin.py:151} INFO - Bilbao
[2023-11-25T07:47:50.550+0000] {logging_mixin.py:151} INFO - Alicante
[2023-11-25T07:47:51.351+0000] {logging_mixin.py:151} INFO - Las-Palmas
[2023-11-25T07:47:51.957+0000] {logging_mixin.py:151} INFO - Tbilisi
[2023-11-25T07:47:52.787+0000] {logging_mixin.py:151} INFO - Hong-Kong
[2023-11-25T07:47:53.091+0000] {taskinstance.py:1943} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 192, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 209, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/scripts/extraction.py", line 88, in extract_livingcost_prices_from_city
    eating_out_table = livingcost_city_page_html.find_all('table', {'class': 'table table-sm table-striped table-hover'})[0].find('tbody').find_all('tr')
IndexError: list index out of range
[2023-11-25T07:47:53.107+0000] {taskinstance.py:1400} INFO - Marking task as FAILED. dag_id=col_api_etl, task_id=extract_livingcost_prices_from_city, execution_date=20231125T074330, start_date=20231125T074609, end_date=20231125T074753
[2023-11-25T07:47:53.121+0000] {standard_task_runner.py:104} ERROR - Failed to execute job 13 for task extract_livingcost_prices_from_city (list index out of range; 1482)
[2023-11-25T07:47:53.174+0000] {local_task_job_runner.py:228} INFO - Task exited with return code 1
